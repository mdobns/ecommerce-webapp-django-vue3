{% extends 'base.html' %}
{% block title %}{{ product.title }} | {% endblock %}
{% block content %}
<div id="productapp" class="max-w-3xl mx-auto bg-gray-900 rounded-2xl shadow-lg p-8 text-gray-200">
    
    <!-- Title -->
    <h1 class="text-3xl font-bold text-white">{{ product.title }}</h1>
    
    <!-- Price -->
    <h2 class="text-xl font-semibold text-pink-400 mt-2">{{ product.price }}à§³</h2>
    
    <!-- Description -->
    {% if product.description %}
        <p class="mt-4 text-gray-300 leading-relaxed">
            {{ product.description }}
        </p>
    {% endif %}

    <!-- Add to Cart Button -->
    <button @click="addToCart({{ product.id }})"
            class="mt-6 px-6 py-3 bg-gradient-to-r from-pink-500 to-purple-600 rounded-xl shadow-md text-white font-medium hover:scale-105 transform transition">
        ðŸ›’ Add to Cart
    </button>
</div>
{% endblock %}

{% block script %}
<script>
const productapp = Vue.createApp({
    delimiters: ['[[', ']]'],
    data() {
        return {}
    },
    mounted() {
        console.log("Mounted")
    },
    methods: {
        addToCart(product_id) {
            console.log('product_id:', product_id)

            var data = {
                'product_id': product_id,
                'update': false,
                'quantity': 1
            }

            fetch('/api/add_to_cart/', {   
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                    'X-CSRFToken': '{{ csrf_token }}'   
                },
                credentials: 'same-origin',  
                body: JSON.stringify(data)   
            })
            .then(response => {
                console.log(response)
            })
            .catch(error => {
                console.error('Error:', error)
            })
        }
    }
})

productapp.mount('#productapp')
</script>
{% endblock %}
