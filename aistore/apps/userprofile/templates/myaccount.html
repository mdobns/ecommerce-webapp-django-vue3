{% extends 'base.html' %}
{% load static %}

{% block title %}My Account |{% endblock %}
{% block content %}
<div class="max-w-4xl mx-auto bg-gray-900 rounded-2xl shadow-lg p-8 text-gray-200 mt-8">
    <div class="flex items-center justify-between mb-6">
        <h1 class="text-3xl font-bold text-white">Welcome to Your Account</h1>
        <form action="{% url 'logout' %}" method="post">
            {% csrf_token %}
            <button type="submit"
                class="inline-block px-6 py-2 bg-gradient-to-r from-red-600 to-blue-500 text-white rounded-xl shadow-md hover:scale-105 transform transition">
                Logout
            </button>
        </form>
    </div>

    <div class="mb-8">
        <h2 class="text-xl font-semibold text-pink-400 mb-2">Account Information</h2>
        <div class="bg-gray-800 rounded-lg p-4">
            <p class="mb-2"><strong>Name:</strong> {{ request.user.get_full_name }}</p>
            <p><strong>E-mail:</strong> {{ request.user.email }}</p>
        </div>
    </div>

    <div>
        <h2 class="text-xl font-semibold text-pink-400 mb-2">Order History</h2>
        <ul>
            {% for order in request.user.orders.all %}
                <li class="mb-6">
                    <div class="font-semibold text-indigo-300 mb-1">Order #{{ order.id }} - {{ order.created_at }}</div>
                    <div class="overflow-x-auto">
                        <table class="min-w-full bg-gray-800 rounded-lg shadow">
                            <thead>
                                <tr>
                                    <th class="px-4 py-2 text-left text-xs font-medium text-gray-400 uppercase">Product</th>
                                    <th class="px-4 py-2 text-left text-xs font-medium text-gray-400 uppercase">Quantity</th>
                                    <th class="px-4 py-2 text-left text-xs font-medium text-gray-400 uppercase">Price</th>
                                </tr>
                            </thead>
                            <tbody>
                                {% for item in order.items.all %}
                                <tr>
                                    <td class="px-6 py-4 whitespace-nowrap">
                                        <a href="{{ item.product.slug }}" class="text-lg font-semibold text-white hover:underline">
                                            {{ item.product.title }}
                                        </a>
                                    </td>
                                    <td class="px-4 py-2">{{ item.quantity }}</td>
                                    <td class="px-4 py-2">{{ item.price }}৳</td>
                                </tr>
                                {% endfor %}
                            </tbody>
                            <tfoot>
                                <tr class="bg-gray-700">
                                    <td class="px-4 py-2 font-bold">Total:</td>
                                    <td class="px-4 py-2 font-bold">{{ order.get_total_item_quantity }}</td>
                                    <td class="px-4 py-2 font-bold text-green-400">{{ order.paid_amount }}৳</td>
                                </tr>
                            </tfoot>
                        </table>
                    </div>
                </li>
            {% empty %}
                <li class="text-gray-400">No orders found.</li>
            {% endfor %}
        </ul>
    </div>
</div>
{% endblock %}